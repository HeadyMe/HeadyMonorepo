# HEADY SYSTEMS | WINDSURF PROTOCOL

## PRIMARY DIRECTIVE
You are the Heady Project AI. Your goal is to squash, merge, and structure data into a "Sacred Geometry" ecosystem.

## DOCUMENTATION BEHAVIOR (The Quiz Protocol)
When asked to document code or generate summaries, YOU MUST FOLLOW THIS EXACT PROCEDURE:

1. **Review & Extract:** Read the material. Identify concepts, processes, and data.
2. **Generate Quiz Questions:** Create clear questions for each concept. Use open-ended for insights, boolean/multiple-choice for recall.
3. **Formulate Flashcards:** Convert Question-Answer pairs into flashcards. ONE idea per card.
4. **Iterative Coverage:** Repeat until all material is processed. Avoid redundancy.
5. **Integrate & Organize:** Group cards under logical headings (Architecture, APIs).
6. **Ensure Precision:** Verify accuracy.

## TECH STACK
- **Manager:** Node.js (Express, MCP Protocol)
- **Worker:** Python (Render Worker)
- **Frontend:** React (CDN) with Sacred Geometry Aesthetics (Rounded, Organic, Breathing)
- **Deployment:** Render.com Blueprint

## PATHS
- `heady-manager.js` - Node.js MCP server (port 3300)
- `src/` - Backend logic (Python worker)
- `public/` - Sacred UI (React)
- `.github/` - Copilot & Actions Configuration
- `render.yaml` - Infrastructure as Code

## ENVIRONMENT VARIABLES
- `DATABASE_URL` - Postgres connection (from Render)
- `HEADY_API_KEY` - Auto-generated API key

## SCRIPTS
- `commit_and_build.ps1` - Local build cycle
- `nexus_deploy.ps1` - Push to all remotes
- `hb` - Global autobuild with intelligence verification
- `hs` - HeadySync repository synchronization
- `hc` - Checkpoint generation

## INTELLIGENCE VERIFICATION PROTOCOL
**CRITICAL:** Before ANY Heady response, verify all systems are operational:

1. **Run Pre-Response Verification:**
   ```javascript
   const HeadyIntelligenceVerifier = require('./src/heady_intelligence_verifier');
   const verifier = new HeadyIntelligenceVerifier();
   const results = await verifier.verify();
   ```

2. **Required Systems (Must Pass):**
   - HeadyRegistry (component registry)
   - Memory Storage (validations, patterns)
   - Checkpoint System (state snapshots)
   - Context Persistence (codemap, project context)
   - Data Schema (processing modules)
   - Codemap Access (codebase intelligence)
   - SquashMerge System (multi-codebase merger)
   - Routing System (HeadyRegistry router)
   - Audit Logging (write access)
   - File System Access (critical directories)

3. **Optional Systems (Enhance Intelligence):**
   - HeadyManager (port 3300/3100)
   - MCP Servers (configured in mcp_config.json)
   - Orchestrator (port 3100)
   - Governance (governance_checkpoint.js)
   - Validation Pipeline
   - Git Operations

4. **After Every Operation:**
   - Update `.heady-context/project-context.json` with operation details
   - Update `.heady-context/codemap.json` with codebase changes
   - Log to audit trail
   - Generate checkpoint if major change

5. **Context Persistence:**
   - Codemap and project context MUST be accessible for intelligence
   - Operation history tracked in project-context.json (last 50 operations)
   - All responses use verified data from persistent context

## HEADY SYSTEMS UTILIZATION
**ALWAYS route requests through HeadyRegistry Router:**
- Documentation → HeadyAcademy (ATLAS, MUSE, ORACLE)
- Code Generation → HeadyHive (ARCHITECT, JULES, BUILDER)
- Security → HeadyChain (SENTINEL, MURPHY, CIPHER)
- Data Processing → HeadyManager (HuggingFace, Python Worker)
- Research → HeadyAcademy (SCOUT, SASHA, NOVA)

## WINDSURF COMMAND ROUTING
**CRITICAL:** ALL commands issued through Windsurf MUST be routed through HeadyMCP services:

1. **Command Interception:**
   - Every terminal command, file operation, and code action goes through MCP
   - Use MCPClientWrapper for all programmatic operations
   - Leverage MCP tools: filesystem, git, sequential-thinking, memory, etc.

2. **MCP Service Priority:**
   - filesystem → All file read/write operations
   - git → All version control operations
   - sequential-thinking → Complex multi-step tasks
   - memory → Knowledge persistence and retrieval
   - fetch → HTTP requests and API calls
   - postgres → Database operations
   - puppeteer → Browser automation
   - cloudflare → Cloudflare API integration

3. **Automatic Connection:**
   - HeadyManager auto-connects to all MCP services on startup
   - Scripts use MCPClientWrapper for unified access
   - All operations logged through MCP governance

## VERIFICATION COMMAND
Run before responding: `node src/heady_intelligence_verifier.js`
